<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Pago con PayPhone - Botón oficial</title>
</head>
<body>
  <h2>Carrito de Compras</h2>
  <p>Total: <strong>$10.00</strong></p>

  <div id="botones"></div>

  <script>
    const token = "OyVLzij-fpLpyYslzFH3cD86SZieQkMj18D36ibqIA0nYnZUHj3mrmGae-UCGc_5LvAQy-LngYEmi5yRqs9aO2UyQ4CITagKa5ng1rpuWZnx9ksf2Ki4NER_FWY3kxhQcu8tGlxGc6csS-q0R1Cvioe8fiNPcTwZBYHZ-cd0QlJtJRk0M1J4SWHxdSnqZszZ4bATNtB6xdNK93Ak-E8Jrnrv_vhCVMxNpttYue63qdyQq5kAd-vuRLBXAVDAl9f_sb7UtuY8EQRorhW074PRSFgJ7fjSPkY7I_jc9gakIXb1oQuEZ9X9UXPp1OcqS4VEACurCFMdp7eQwHpNe9_NgflubsQ";
    const storeId = "b9877bb5-16ef-4d29-84d7-f71d6e93b76e";
    const monto = 1000; // $10.00 en centavos
    const transactionId = Date.now().toString();

    const headers = {
      "Content-Type": "application/json",
      "Authorization": "Bearer " + token,
    };

    const data = {
      amount: monto,
      amountWithoutTax: monto,
      amountWithTax: 0,
      tax: 0,
      reference: "Pago prueba GitHub",
      currency: "USD",
      clientTransactionId: transactionId,
      storeId: storeId,
      ResponseUrl: "https://www.macvasquez.com/gracias"
    };

    fetch("https://pay.payphonetodoesposible.com/api/button/Prepare", {
      method: "POST",
      headers: headers,
      body: JSON.stringify(data)
    })
    .then(res => res.json())
    .then(data => {
      console.log(data);
      const container = document.getElementById("botones");

      if (data.payWithPayPhone || data.payWithCard) {
        if (data.payWithPayPhone) {
          const btnPhone = document.createElement("a");
          btnPhone.href = data.payWithPayPhone;
          btnPhone.textContent = "Pagar con PayPhone App";
          btnPhone.style.marginRight = "20px";
          btnPhone.target = "_blank";
          container.appendChild(btnPhone);
        }

        if (data.payWithCard) {
          const btnCard = document.createElement("a");
          btnCard.href = data.payWithCard;
          btnCard.textContent = "Pagar con Tarjeta";
          btnCard.target = "_blank";
          container.appendChild(btnCard);
        }
      } else {
        container.innerText = "⚠️ Error al generar enlaces de pago:\n" + JSON.stringify(data);
      }
    })
    .catch(error => {
      document.getElementById("botones").innerText = "❌ Error al conectar con PayPhone: " + error;
    });
  </script>
</body>
</html>
